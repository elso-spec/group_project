---
title: "Plots"
author: "Elisabeth Solmunde"
format: html
editor: visual
---

# Exploring trends in life expectancies in different regions of the world 


## Life expectancies per region 
```{r}
life_expectancy_region |> 
  group_by(Continent, Decade) |> 
  summarise(mean_life_expectancy = mean(LifeExpectancy)) |> 
  ggplot(aes(x = Decade, y = mean_life_expectancy, color = Continent), na.rm = T) +
  geom_point() + 
  geom_smooth(se = F) + 
  scale_x_continuous(breaks = seq(1950, 2010, by = 10)) +
  theme_classic() +
  labs(
    x = "Year",
    y = "Mean life expectancy (years)",
    title = "Mean life expectancies from 1950 to 2010, by continent"
  )
```

## Life expectancies in high vs. low income countries 
```{r}
income_groups |> 
  group_by(Entity, Decade) |> 
  summarise(mean_life_expectancy = mean(LifeExpectancy)) |> 
  ggplot(aes(x = Decade, y = mean_life_expectancy, color = Entity), na.rm = T) +
  geom_point() +
  geom_smooth() +
  scale_x_continuous(breaks = seq(1950, 2010, by = 10)) +
  theme_classic() +
  labs(
    x = "Year",
    y = "Mean life expectancy (years)",
    title = "Mean life expectancies from 1950 to 2010, by income group",
    color = "Income groups"
  )
```
```{r}
life_expectancy |> 
  group_by(Entity, Decade) |> 
  summarise()
```

```{r}
life_expectancy_female_male_regions |> 
  group_by(Continent, Decade) |> 
  summarise(mean_difference = mean(LifeExpectancyDiffFM)) |> 
  ggplot(aes(x = Decade, y = mean_difference, color = Continent), na.rm = T) +
  geom_point() +
  geom_smooth(se = F) +
  scale_x_continuous(breaks = seq(1950, 2010, by = 10)) +
  theme_classic() +
  labs(
    x = "Year",
    y = "Mean difference in life expectancy (years)",
    title = "Mean difference in life expectancies from 1950 to 2010"
  )
```
```{r}
life_expectancy_region |> 
  ggplot(aes(x = Year, y = LifeExpectancy, color = Entity)) +
  geom_point() +
  facet_wrap(~ Region)
```
```{r}
# Life expectancy by country (1960-2020)
ggplot(life_expectancy_change, aes(x = Year, y = Entity, fill = LifeExpectancy)) +
  geom_tile() +
  scale_fill_viridis_c(option = "plasma", name = "Life Expectancy") +
  labs(title = "Life Expectancy by Country (1960–2020)",
       x = "Year", y = "Country") +
  theme_minimal() +
  theme(axis.text.y = element_text(size = 6))

```



```{r}
# Changes in life expectancies
life_expectancy_change <- life_expectancy_change %>%
  group_by(Entity) %>%
  arrange(Year) %>%
  mutate(delta = LifeExpectancy - lag(LifeExpectancy)) %>%
  ungroup()

ggplot(life_expectancy_change, aes(x = Year, y = Entity, fill = delta)) +
  geom_tile() +
  scale_fill_gradient2(low = "red", mid = "white", high = "blue",
                       midpoint = 0, name = "Δ Life Expectancy") +
  labs(title = "Year-to-Year Change in Life Expectancy (1960–2020)",
       x = "Year", y = "Country") +
  theme_minimal() +
  theme(axis.text.y = element_text(size = 6))
```
```{r}
# Life expectancy by region (1960-2020)
life_expectancy_region |> 
  filter(Year >= 1950 & Year <= 2020) |> 
  group_by(Region, Year) |> 
  summarise(mean_le = mean(LifeExpectancy)) |> 
  ggplot(aes(x = Year, y = Region, fill = mean_le)) +
  geom_tile() +
  scale_fill_viridis_c(option = "plasma", name = "Life Expectancy") +
  labs(title = "Life Expectancy by Region (1960–2020)",
       x = "Year", y = "Region") +
  theme_minimal() +
  theme(axis.text.y = element_text(size = 6))
```


